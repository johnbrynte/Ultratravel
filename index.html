<!DOCTYPE HTML>
<html>
<head>
<link href="ultrastyle.css" rel="stylesheet" type="text/css" />
<link href="normalize.css" rel="stylesheet" type="text/css" />
<script src="http://code.jquery.com/jquery-1.7.js" type="text/javascript">
</script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyB56g-mbdIen-j9jhHmAPXTS7ideqnbCn8&sensor=true">
    </script>
<script type="text/javascript">

var minimized = 35;
var maximized = 400;

var map;
var geocoder;
var line;
var markers = [];

$(document).ready(function() {
	$(".section").height(minimized);
	$("#booking .section:first-child").height(maximized);
	var sectionHeaders = $(".section > h1");
	sectionHeaders.first().addClass("active_section");

	sectionHeaders.click(function() {
		if ($(this).parent().height() > minimized) 
			return;
		
		$(".active_section").removeClass("active_section");
		$(this).addClass("active_section");


		var collapse = {};
		collapse["height"] = minimized;
		$("#booking > .section:not(this:parent)").animate(collapse, 300, null);

		var parameters = {};
		parameters["height"] = maximized;
		$(this).parent().animate(parameters, 200, null);
	});


	// GOOGLE MAPZ
	var myOptions = {
		disableDefaultUI: true,
		scrollwheel: false,
		center: new google.maps.LatLng(50, 0),
		zoom: 3,
		mapTypeId: google.maps.MapTypeId.ROADMAP,
		styles: [{
				featureType: "all",
				stylers: [
				{ saturation: -100 },
				]
			}]
	};
	
	map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

	geocoder = new google.maps.Geocoder();

	$("#fromaddress").keypress(function(event) {
		if(event.which == 13) {
			codeAddress(0, $(this).attr("value"));
		}
	});

	$("#toaddress").keypress(function(event) {
		if(event.which == 13) {
			codeAddress(1, $(this).attr("value"));
		}
	});

	document.getElementById("fromaddress").focus();
});

function codeAddress(index,address) {
	geocoder.geocode( { 'address': address}, function(results, status) {
		if (status == google.maps.GeocoderStatus.OK) {
			if (markers[index])
				markers[index].setMap(null);

			markers[index] = new google.maps.Marker({
				map: map,
				position: results[0].geometry.location,
				animation: google.maps.Animation.BOUNCE
			});
			map.setCenter(results[0].geometry.location);

			if (markers[1] && markers[0]) {
				if (line)
					line.setMap(null);

				var p1 = markers[0].getPosition();
				var p2 = markers[1].getPosition();

				line = new google.maps.Polyline({
					map: map,
					path: new google.maps.MVCArray([ p1, p2 ]),
					strokeColor: "#f00",
					geodesic: true
				});
/*
				var a,b;
				a = p2.lat() - p1.lat();
				b = p2.lng() - p1.lng();
				
				if (p1.lat() > p2.lat())
					a = p1.lat() - p2.lat();
				if (p1.lng() > p2.lng())
					b = p1.lng() - p2.lng();
				
				map.setCenter(new google.maps.LatLng(a,b));
				map.setCenter(new google.maps.LatLngBounds(
					markers[0].getPosition(),
					markers[1].getPosition())
					.getCenter()
				);
*/
			}
		} else {
			alert("Geocode was not successful for the following reason: " + status);
		}
	});
}

</script>
</head>
<body>

<div id="menu">
<img src="ultratravel_logo.png" />
<img id="earth" src="earth_turn.gif" />
	<div id="login">
	<h2>Not logged in</h2>
	<p>login <a href="#">here</a></p>
	</div>
</div>

<div id="map_canvas"></div>

<div id="content">

	<div id="booking">
		<div class="section">
		<h1>Destination</h1>
		<h2>Header 1</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur accumsan condimentum fringilla. Phasellus id mi in velit posuere vulputate. Morbi enim tellus, semper at bibendum id, tristique quis erat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac.</p>
		<p>Fr&aring;n:
		<input id="fromaddress" type="text" value="Stockholm" /></p>
		<p>Till:
		<input id="toaddress" type="text" value="Las Vegas" /></p>
		</div>

		<div class="section">
		<h1>Section 2</h1>
		<h2>Header 2</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur accumsan condimentum fringilla. Phasellus id mi in velit posuere vulputate. Morbi enim tellus, semper at bibendum id, tristique quis erat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac.</p>
		</div>

		<div class="section">
		<h1>Section 3</h1>
		<h2>Header 3</h2>
		<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur accumsan condimentum fringilla. Phasellus id mi in velit posuere vulputate. Morbi enim tellus, semper at bibendum id, tristique quis erat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac.</p>
		</div>

	</div>

</div>

</body>
</html>
